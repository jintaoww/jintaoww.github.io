{% include base_path %}

<div class="page__footer-follow">
  <ul class="social-icons">
    {% if site.data.ui-text[site.locale].follow_label %}
      <li><strong>{{ site.data.ui-text[site.locale].follow_label }}</strong></li>
    {% endif %}
    {% if site.twitter.username %}
      <li><a href="https://twitter.com/{{ site.twitter.username }}"><i class="fab fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    {% endif %}
    {% if site.facebook.username %}
      <li><a href="https://facebook.com/{{ site.facebook.username }}"><i class="fab fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
    {% endif %}
    {% if site.author.github %}
      <li><a href="http://github.com/{{ site.author.github }}"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    {% endif %}
    {% if site.author.bitbucket %}
      <li><a href="http://bitbucket.org/{{ site.author.bitbucket }}"><i class="fab fa-bitbucket" aria-hidden="true"></i> Bitbucket</a></li>
    {% endif %}
    <li><a href="{% if site.atom_feed.path %}{{ site.atom_feed.path }}{% else %}{{ base_path }}/feed.xml{% endif %}"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> {{ site.data.ui-text[site.locale].feed_label | default: "Feed" }}</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; {{ site.time | date: '%Y' }} {{ site.name | default: site.title }}. {{ site.data.ui-text[site.locale].powered_by | default: "Powered by" }} <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>


<!-- Live2D Áå´Âí™Ê®°ÂûãÔºöÁôΩÁå´ -->
<!-- Live2D Êèí‰ª∂ -->
<script src="https://cdn.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.min.js"></script>
<script>
  L2Dwidget.init({
    model: {
      jsonPath: "https://unpkg.com/live2d-widget-model-tororo@1.0.5/assets/tororo.model.json",
    },
    display: {
      position: "right",
      width: 150,
      height: 300,
    },
    mobile: {
      show: true,
      scale: 0.5
    },
    react: {
      opacityDefault: 0.7,
      opacityOnHover: 1
    }
  });
</script>


<!-- üåó ‰∏ªÈ¢òÂàáÊç¢ÊåâÈíÆ -->
<!-- üåó È´òÁ∫ß‰∏ªÈ¢òÂàáÊç¢ÊåâÈíÆ -->
<style>
  #theme-toggle {
    position: fixed;
    left: 50px;
    bottom: 60px;
    width: 42px;
    height: 42px;
    border: none;
    border-radius: 50%;
    font-size: 20px;
    cursor: pointer;
    z-index: 2000;
    background: #333;
    color: #fff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  }

  #theme-toggle[data-theme="dark"]::after {
    content: "üåô";
  }

  #theme-toggle[data-theme="light"]::after {
    content: "‚òÄÔ∏è";
  }
</style>

<button id="theme-toggle" title="ÂàáÊç¢‰∏ªÈ¢ò" data-theme="dark"></button>

<script>
  const body = document.body;
  const toggle = document.getElementById("theme-toggle");
  const darkClass = "theme-dark";
  const lightClass = "theme-light";

  const systemPrefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
  const savedTheme = localStorage.getItem("theme-mode");
  const initialTheme = savedTheme || (systemPrefersDark ? darkClass : lightClass);

  body.classList.add(initialTheme);
  toggle.setAttribute("data-theme", initialTheme === darkClass ? "dark" : "light");

  toggle.addEventListener("click", () => {
    const isDark = body.classList.contains(darkClass);
    const newTheme = isDark ? lightClass : darkClass;
    const newAttr = isDark ? "light" : "dark";

    body.classList.replace(isDark ? darkClass : lightClass, newTheme);
    toggle.setAttribute("data-theme", newAttr);
    localStorage.setItem("theme-mode", newTheme);
  });
</script>


<script>
  let starCanvas = null;
  let ctx, w, h;
  const stars = [];
  const STAR_NUM = 200;
  let animationId;

  // ÂàõÂª∫Âπ∂ÊèíÂÖ• canvas
  function createStarCanvas() {
    starCanvas = document.createElement("canvas");
    starCanvas.id = "starfield";
    document.body.appendChild(starCanvas);

    ctx = starCanvas.getContext("2d");
    resizeCanvas();

    for (let i = 0; i < STAR_NUM; i++) {
      stars.push({ x: Math.random() * w, y: Math.random() * h, z: Math.random() * w });
    }

    window.addEventListener("resize", resizeCanvas);
    animateStars();
  }

  function resizeCanvas() {
    w = starCanvas.width = window.innerWidth;
    h = starCanvas.height = window.innerHeight;
  }

  function animateStars() {
    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, w, h);
    ctx.fillStyle = "white";

    for (let i = 0; i < STAR_NUM; i++) {
      const star = stars[i];
      star.z -= 2;
      if (star.z <= 0) star.z = w;

      const k = 128.0 / star.z;
      const px = star.x * k + w / 2;
      const py = star.y * k + h / 2;

      if (px >= 0 && px <= w && py >= 0 && py <= h) {
        const size = (1 - star.z / w) * 2;
        ctx.beginPath();
        ctx.arc(px, py, size, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    animationId = requestAnimationFrame(animateStars);
  }

  function destroyStarCanvas() {
    if (starCanvas) {
      cancelAnimationFrame(animationId);
      window.removeEventListener("resize", resizeCanvas);
      starCanvas.remove();
      starCanvas = null;
    }
  }

  // ÂàùÊ¨°Âä†ËΩΩÔºàÊ£ÄÊü•‰∏ªÈ¢òÔºâ
  const currentTheme = document.body.classList.contains("theme-dark") ? "dark" : "light";
  if (currentTheme === "dark") createStarCanvas();

  // ÂìçÂ∫î‰∏ªÈ¢òÂàáÊç¢ÊåâÈíÆ
  document.getElementById("theme-toggle")?.addEventListener("click", () => {
    const isNowDark = document.body.classList.contains("theme-dark");
    if (isNowDark) {
      createStarCanvas();
    } else {
      destroyStarCanvas();
    }
  });
</script>